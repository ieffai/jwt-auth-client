(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{120:function(e,t,n){"use strict";n.r(t),n.d(t,"Context",(function(){return Z}));var r=n(0),a=n.n(r),o=n(10),s=n.n(o),i=(n(91),n(12)),c=n.n(i),u=n(17),l=n(38),h=n(157),d=n(158),p=n(159),j=n(160),b=n(75),g=n(73),f=n.n(g),v=n(155),m=n(153),x=Object(m.a)((function(e){return{menuButton:{marginRight:e.spacing(1)},mainFeaturesPost:{position:"relative",color:e.palette.common.white,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center",minHeight:"100vh"},overlay:{position:"absolute",top:0,bottom:0,right:0,left:0,backgroundColor:"rgba(0,0,0,.3)"},title:{flexGrow:1},mainFeaturesPostContent:{position:"relative",padding:e.spacing(6),marginTop:e.spacing(8)}}})),O=n(4);var k=function(){var e=x(),t=a.a.useContext(Z);return Object(O.jsx)(h.a,{position:"fixed",children:Object(O.jsx)(d.a,{fixed:!0,children:Object(O.jsxs)(p.a,{children:[Object(O.jsx)(j.a,{edge:"start",color:"inherit","aria-label":"menu",className:e.menuButton,children:Object(O.jsx)(f.a,{})}),Object(O.jsx)(b.a,{variant:"h6",className:e.title,children:t.isAuth?"".concat(t.user.email):"JWT App"}),t.isAuth?Object(O.jsx)(v.a,{onClick:function(){return t.logout()},variant:"contained",color:"secondary",children:"Log Out"}):Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(F,{popupName:"Log In",buttonName:"Log In",buttonColor:"inherit",buttonVariant:"outlined"}),Object(O.jsx)(F,{popupName:"Sign Up",buttonName:"Sign Up",buttonColor:"secondary",buttonVariant:"contained"})]})]})})})},y=n(52),w=n(167),C=n(166),A=n(169),L=n(164),N=n(161),I=n(162),S=n(163);var F=Object(y.a)((function(e){var t=e.popupName,n=e.buttonColor,r=e.buttonVariant,o=e.buttonName,s=a.a.useContext(Z),i=a.a.useState(!1),c=Object(l.a)(i,2),u=c[0],h=c[1],d=function(){h(!1)},p=a.a.useState(""),j=Object(l.a)(p,2),b=j[0],g=j[1],f=a.a.useState(""),m=Object(l.a)(f,2),x=m[0],k=m[1];return Object(O.jsxs)(w.a,{mr:3,children:[Object(O.jsx)(v.a,{onClick:function(){h(!0)},color:n,variant:r,children:o}),Object(O.jsxs)(A.a,{open:u,onClose:d,"aria-labelledby":"form-dialog-title",children:[Object(O.jsxs)(N.a,{id:"form-dialog-title",children:[t," form"]}),Object(O.jsxs)(I.a,{children:[Object(O.jsx)(S.a,{children:"LOG IN TO SEE WHAT WILL HAPPEN"}),Object(O.jsx)(C.a,{autoFocus:!0,margin:"dense",id:"name",label:"Email",type:"email",fullWidth:!0,onChange:function(e){return g(e.target.value)},value:b}),Object(O.jsx)(C.a,{autoFocus:!0,margin:"dense",id:"pass",label:"Password",type:"Password",fullWidth:!0,onChange:function(e){return k(e.target.value)},value:x})]}),Object(O.jsxs)(L.a,{children:[Object(O.jsx)(v.a,{onClick:d,color:"primary",children:"Cancel"}),Object(O.jsx)(v.a,{onClick:function(){return function(e){"Log In"===e?s.login(b,x):s.registration(b,x),null===s.error?h(!1):console.log("test")}(o)},color:"primary",children:o})]})]})]})})),P=n(165),E=n(123);var T=function(){var e=a.a.useContext(Z),t=e.user.email,n=x(),r=function(){console.log(e.user.email)};return Object(O.jsx)(O.Fragment,{children:Object(O.jsx)(E.a,{className:n.mainFeaturesPost,style:{backgroundImage:"url(https://source.unsplash.com/random)"},children:Object(O.jsxs)(d.a,{fixed:!0,children:[Object(O.jsx)("div",{className:n.overlay}),e.isAuth?Object(O.jsx)(O.Fragment,{children:Object(O.jsx)(P.a,{container:!0,children:Object(O.jsxs)("div",{className:n.mainFeaturesPostContent,children:[Object(O.jsxs)(b.a,{component:"h1",variant:"h3",color:"inherit",gutterBottom:!0,children:["So, ",t," you finally get registered"]}),Object(O.jsx)(b.a,{variant:"h5",color:"inherit",paragraph:!0,children:"What a pleasure"}),Object(O.jsx)(v.a,{onClick:r,color:"secondary",variant:"contained",children:"GET"})]})})}):Object(O.jsx)(O.Fragment,{children:Object(O.jsx)(P.a,{container:!0,children:Object(O.jsxs)("div",{className:n.mainFeaturesPostContent,children:[Object(O.jsx)(b.a,{component:"h1",variant:"h3",color:"inherit",gutterBottom:!0,children:"JWT Authorization and registration"}),Object(O.jsx)(b.a,{variant:"h5",color:"inherit",paragraph:!0,children:"On this App you will see my logic for authorization and registration"}),Object(O.jsx)(F,{popupName:"Log In",buttonName:"Lets go!",buttonColor:"secondary",buttonVariant:"contained"})]})})})]})})})};var U=function(){return Object(O.jsx)(O.Fragment,{children:Object(O.jsx)(T,{})})},B=n(34),W=n(35),R=n(42),z=n.n(R),H="http://localhost:5000/api",J=z.a.create({withCredentials:!0,baseURL:H});J.interceptors.request.use((function(e){return e.headers.Authorization="Bearer ".concat(localStorage.getItem("token")),e})),J.interceptors.response.use((function(e){return e}),function(){var e=Object(u.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.config,401!==t.response.status||!t.config||t.config._isRetry){e.next=14;break}return n._isRetry=!0,e.prev=3,e.next=6,z.a.get("".concat(H,"/refresh"),{withCredentials:!0});case 6:return r=e.sent,localStorage.setItem("token",r.data.accessToken),e.abrupt("return",J.request(n));case 11:e.prev=11,e.t0=e.catch(3),console.log("UNATHORIZED");case 14:throw t;case 15:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}());var V=J;var G=Object(y.a)((function(){var e=a.a.useContext(Z),t=a.a.useState([]),n=Object(l.a)(t,2);return n[0],n[1],a.a.useEffect((function(){localStorage.getItem("token")&&e.checkAuth()}),[]),e.isLoading?Object(O.jsx)("div",{children:"...Loading"}):Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(k,{a:e.isAuth}),Object(O.jsx)(U,{})]})})),q=n(14),_=function(){function e(){Object(B.a)(this,e)}return Object(W.a)(e,null,[{key:"login",value:function(){var e=Object(u.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V.post("/login",{email:t,password:n}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"registration",value:function(){var e=Object(u.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V.post("/registration",{email:t,password:n}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(u.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V.post("/logout"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),D=new(function(){function e(){Object(B.a)(this,e),this.user={},this.isAuth=!1,this.isLoading=!1,this.error=null,Object(q.d)(this,{},{autoBind:!0})}return Object(W.a)(e,[{key:"setAuth",value:function(e){this.isAuth=e}},{key:"setUser",value:function(e){this.user=e}},{key:"setLoading",value:function(e){this.isLoading=e}},{key:"setError",value:function(e){this.error=e}},{key:"login",value:function(){var e=Object(u.a)(c.a.mark((function e(t,n){var r,a,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_.login(t,n);case 3:r=e.sent,localStorage.setItem("token",r.data.accessToken),this.setAuth(!0),this.setUser(r.data.user),console.log(r.data.user.email),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(null===(a=e.t0.response)||void 0===a||null===(o=a.data)||void 0===o?void 0:o.message);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"registration",value:function(){var e=Object(u.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_.registration(t,n);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),this.setError(e.t0);case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(u.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_.logout();case 3:e.sent,localStorage.removeItem("token"),this.setAuth(!1),this.setUser({}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(null===(t=e.t0.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"checkAuth",value:function(){var e=Object(u.a)(c.a.mark((function e(){var t,n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setLoading(!0),e.prev=1,e.next=4,z.a.get("".concat(H,"/refresh"),{withCredentials:!0});case 4:t=e.sent,localStorage.setItem("token",t.data.accessToken),this.setAuth(!0),this.setUser(t.data.user),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(null===(n=e.t0.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message);case 13:return e.prev=13,this.setLoading(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[1,10,13,16]])})));return function(){return e.apply(this,arguments)}}()}]),e}()),Z=a.a.createContext({store:D});s.a.render(Object(O.jsx)(Z.Provider,{value:D,children:Object(O.jsx)(G,{})}),document.getElementById("root"))},91:function(e,t,n){}},[[120,1,2]]]);
//# sourceMappingURL=main.297666c2.chunk.js.map